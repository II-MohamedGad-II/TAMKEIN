{% extends "home/homepage.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    {%block content%}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            margin-top: 20px;
        }
        nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 1000;
    background-color: #000000;
}


        .form-container {
            background: #ffffff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 650px;
            position: relative;
            overflow: hidden;
            margin: 100px;
        }

        .form-container h2 {
            color: #6163ea;
            margin-bottom: 40px;
            font-size: 36px;
            font-weight: 700;
            text-align: center;
        }

        .form-container .form-group {
            margin-bottom: 30px;
    
        }

        .form-container .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #4b5563;
            font-weight: 500;
            font-size: 16px;
        }

        .form-container .form-group input,
        .form-container .form-group select,
        .form-container .form-group textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .form-container .form-group input:focus,
        .form-container .form-group select:focus,
        .form-container .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 8px rgba(99, 102, 241, 0.5);
        }

        /* Radio button styles */
        .form-group input[type="radio"] {
            width: auto;
            margin-right: 10px;
            position: relative;
            top: 3px;
        }

        .form-group .disability,
        .form-group .cs-knowledge {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        /* Button styles */
        .form-container .buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
        }

        .form-container .buttons button.L-submit {
            background: #6366f1;
            color: #ffffff;
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .form-container .buttons button.L-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .form-container .buttons button.prev,
        .form-container .buttons button.next {
            background: #4b5563;
            color: #ffffff;
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .form-container .buttons button.prev:hover,
        .form-container .buttons button.next:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .progress-bar-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: #e5e7eb;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: #6366f1;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="progress-bar-container">
            <div class="progress-bar"></div>
        </div>

       <!-- Step 1: Info Details -->
<div class="step" data-step="1">
    <h2>Info Details</h2>
    <div class="form-group">
        <label for="disability-status">Do you have any disability?</label>
        <div class="d-flex">
            <div class="disability d-flex">
                <input class="form-check-input" type="radio" name="disabilityStatus" id="hasDisability" value="yes" required aria-labelledby="hasDisabilityLabel">
                <label class="form-check-label" id="hasDisabilityLabel" for="hasDisability">Yes</label>
            </div>
            <div class="disability d-flex">
                <input class="form-check-input" type="radio" name="disabilityStatus" id="noDisability" value="no" required aria-labelledby="noDisabilityLabel">
                <label class="form-check-label" id="noDisabilityLabel" for="noDisability">No</label>
            </div>
        </div>
        <div id="disability-options" style="display: none; margin-top: 10px;">
            <label for="disability-type">Please select your disability type:</label>
            <select id="disability-type" name="disabilityType">
                <option value="visual">Visual Impairment</option>
                <option value="hearing">Hearing Impairment</option>
                <option value="physical">Physical Impairment</option>
                <option value="cognitive">Cognitive Impairment</option>
                <option value="noDisability">No Disability</option>
            </select>
        </div>
        <div class="error">This field is required.</div>
    </div>

    <div class="buttons">
        <button class="next">Next Step</button>
    </div>
</div>


        <!-- Step 2: CS Knowledge -->
        <div class="step" data-step="2" style="display: none;">
            <h2>Explore Your Path</h2>
            <div class="form-group">
                <label for="cs-knowledge">Do you have previous knowledge in Computer Science (CS)?</label>
                <div class="d-flex">
                    <div class="cs-knowledge d-flex">
                        <input class="form-check-input" type="radio" name="csKnowledge" id="csYes" value="yes" required>
                        <label class="form-check-label" for="csYes">Yes</label>
                    </div>
                    <div class="cs-knowledge d-flex">
                        <input class="form-check-input" type="radio" name="csKnowledge" id="csNo" value="no" required>
                        <label class="form-check-label" for="csNo">No</label>
                    </div>
                </div>
                <div class="error">This field is required.</div>
            </div>

            <div id="cs-details-container" style="display: none;">
                <div class="form-group">
                    <label for="interest">What is your primary interest?</label>
                    <form method="get" action="{% url 'get_questions' %}">
                    <select name="interest" id="interest" required aria-labelledby="interestLabel">
                        <option value disabled selected>Select your interest</option>
                        <option value="AI">Artificial Intelligence</option>
                        <option value="Robotics">Robotics</option>
                        <option value="Data Science">Data Science</option>
                        <option value="Data Engineering">Data Engineering</option>
                        <option value="Web Development">Web Development</option>
                        <option value="Mobile app">Mobile app development</option>
                        <option value="Network">Network</option>
                        <option value="Cybersecurity">Cybersecurity</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="level">What is your level in the chosen track?</label>
                    <select name="level" id="level" required aria-labelledby="levelLabel">
                        <option value disabled selected>Select your level</option>
                        <option value="Beginner">Beginner</option>
                        <option value="Intermediate">Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Quiz">Take this quiz to determine your level!</option>
                    </select>
                </div>
                <div id="quiz-container" style="display: none;">
                    <div id="questions-container"></div>
                </div>
                
                
          <!-- Hidden Quiz Container -->
          
            </div>

            <div id="cs-suggestion-container" style="display: none;">
                <div class="form-group">
                    <label for="suggestion">Would you like us to suggest some courses tracks to explore?</label>
                    <div class="d-flex">
                        <div class="cs-suggestion d-flex">
                            <input class="form-check-input" type="radio" name="csSuggestion" id="suggestYes" value="yes" required>
                            <label class="form-check-label" for="suggestYes">Yes</label>
                        </div>
                        <div class="cs-suggestion d-flex">
                            <input class="form-check-input" type="radio" name="csSuggestion" id="suggestNo" value="no" required>
                            <label class="form-check-label" for="suggestNo">No</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="buttons">
                <button class="prev">Previous</button>
                <button type="submit" class="L-submit">Submit</button>
            </div>
        </div>

    <script>
  
    document.addEventListener("DOMContentLoaded", () => {
        const hasDisability = document.getElementById("hasDisability");
        const noDisability = document.getElementById("noDisability");
        const disabilityOptions = document.getElementById("disability-options");

        // Function to toggle visibility of disability options
        const toggleDisabilityOptions = () => {
            if (hasDisability.checked) {
                disabilityOptions.style.display = "block";
            } else {
                disabilityOptions.style.display = "none";
            }
        };

        // Add event listeners to radio buttons
        hasDisability.addEventListener("change", toggleDisabilityOptions);
        noDisability.addEventListener("change", toggleDisabilityOptions);

        // Initialize the state
        toggleDisabilityOptions();
    });


    document.addEventListener('DOMContentLoaded', () => {
    const interestSelect = document.getElementById('interest');
    const levelSelect = document.getElementById('level');
    const quizContainer = document.getElementById('quiz-container');
    const questionsContainer = document.getElementById('questions-container');

   // عند اختيار التراك
   document.getElementById('interest').addEventListener('change', (e) => {
       const selectedInterest = e.target.value;
       localStorage.setItem('selectedInterest', selectedInterest); // تخزين التراك
   });

    // عندما يختار المستخدم "Quiz"
    levelSelect.addEventListener('change', () => {
        const selectedInterest = localStorage.getItem('selectedInterest');  // استرجاع التراك من localStorage

        // إذا اختار "Quiz" ولكن لم يحدد التراك
        if (levelSelect.value === 'Quiz') {
            if (!selectedInterest) {
                alert('Please select a track first!');
                levelSelect.value = '';  // إلغاء اختيار "Quiz" إذا لم يتم تحديد التراك
                return;
            }

            if (questions[selectedInterest]) {
                quizContainer.style.display = 'block';
                questionsContainer.innerHTML = ''; // أفرغ الأسئلة القديمة
                
                // عرض الأسئلة الخاصة بالتراك المحدد
                questions[selectedInterest].forEach((question, index) => {
                    const questionElement = document.createElement('div');
                    questionElement.classList.add('question');
                    questionElement.innerHTML = `
                        <label for="question${index}">${question}</label>
                        <input type="text" name="question${index}" id="question${index}" required />
                    `;
                    questionsContainer.appendChild(questionElement);
                });
            } else {
                // alert('Failed to load questions. Please try again.');
            }
        } else {
            quizContainer.style.display = 'none';
        }
    });
});

document.addEventListener('DOMContentLoaded', () => {
    const levelSelect = document.getElementById('level');
    const container = document.createElement('div'); // لإنشاء حاوية للزر
    container.style.marginTop = '20px'; // إضافة مسافة صغيرة

    const quizButton = document.createElement('button'); // إنشاء الزر
    quizButton.textContent = 'Start the Quiz';
    quizButton.style.display = 'none'; // إخفاء الزر بشكل افتراضي
    quizButton.addEventListener('click', () => {
        // إعادة التوجيه إلى صفحة الاستبيان/الاختبار
        window.location.href = '/questionnaire/quiz_form/';
    });

    container.appendChild(quizButton);
    levelSelect.parentNode.insertBefore(container, levelSelect.nextSibling);

    levelSelect.addEventListener('change', () => {
        if (levelSelect.value === 'Quiz') {
            quizButton.style.display = 'inline-block'; // عرض الزر عند اختيار Quiz
        } else {
            quizButton.style.display = 'none'; // إخفاء الزر إذا تم اختيار شيء آخر
        }
    });
});

        document.addEventListener('DOMContentLoaded', () => {
            const steps = document.querySelectorAll('.step');
            const progressBar = document.querySelector('.progress-bar');
            let currentStep = 1;
    
            const csYes = document.getElementById('csYes');
            const csNo = document.getElementById('csNo');
            const csDetailsContainer = document.getElementById('cs-details-container');
            const csSuggestionContainer = document.getElementById('cs-suggestion-container');
            const levelSelect = document.getElementById('level');
            const quizContainer = document.getElementById('quiz-container');
    
            // Show/hide CS knowledge dropdowns based on selection
            csYes.addEventListener('change', () => {
                csDetailsContainer.style.display = 'block';
                csSuggestionContainer.style.display = 'none';
            });
    
            csNo.addEventListener('change', () => {
                csDetailsContainer.style.display = 'none';
                csSuggestionContainer.style.display = 'block';
            });
    
            // Show/hide quiz based on the level selection
            levelSelect.addEventListener('change', () => {
                if (levelSelect.value === 'Quiz') {
                    quizContainer.style.display = 'block';
                    // Fetch quiz data from the server
                    fetch('/get-quiz-data/')
                        .then(response => response.json())
                        .then(data => {
                            quizContainer.innerHTML = ''; // Clear existing content
                            data.forEach(track => {
                                const trackTitle = document.createElement('h3');
                                trackTitle.textContent = `Track: ${track.name}`;
                                quizContainer.appendChild(trackTitle);
    
                                track.questions.forEach(question => {
                                    const questionText = document.createElement('p');
                                    questionText.textContent = `- Question: ${question.question_text}`;
                                    quizContainer.appendChild(questionText);
                                });
                            });
                        })
                        .catch(error => console.error('Error fetching quiz data:', error));
                } else {
                    quizContainer.style.display = 'none';
                }
            });
    
            // Update the progress bar based on the current step
            const updateProgress = () => {
                const progress = ((currentStep - 1) / (steps.length - 1)) * 100;
                progressBar.style.width = `${progress}%`;
            };
    
            // Handle navigation to the next step
            const handleNext = () => {
                if (currentStep < steps.length) {
                    document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'none';
                    currentStep++;
                    document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'block';
                    updateProgress();
                }
            };
    
            // Handle navigation to the previous step
            const handlePrev = () => {
                if (currentStep > 1) {
                    document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'none';
                    currentStep--;
                    document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'block';
                    updateProgress();
                }
            };
    
            // Event listeners for navigation buttons
            document.querySelectorAll('.next').forEach(button => {
                button.addEventListener('click', handleNext);
            });
    
            document.querySelectorAll('.prev').forEach(button => {
                button.addEventListener('click', handlePrev);
            });
    
            // Initialize the progress bar
            updateProgress();
        });

fetch('/get-quiz-data/')
    .then(response => response.json())
    .then(data => {
        console.log(data);  // هذه الجملة تظهر لنا البيانات في الـ Console
        // باقي الكود لعرض الأسئلة
    })
    .catch(error => {
        console.error('Error fetching quiz data:', error);
        quizContent.innerHTML = '<p>فشل تحميل الأسئلة.</p>';
    });
    data.forEach(track => {
    const trackTitle = document.createElement('h3');
    trackTitle.textContent = `Track: ${track.name}`;
    quizContainer.appendChild(trackTitle);

    track.questions.forEach(question => {
        const questionText = document.createElement('p');
        questionText.textContent = `- Question: ${question.question_text}`;
        quizContainer.appendChild(questionText);
    });
});
// Update the currentStep and show the correct step
const handleNext = () => {
    if (currentStep < steps.length) {
        document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'none';
        currentStep++;
        document.querySelector(`.step[data-step="${currentStep}"]`).style.display = 'block';
        updateProgress();
    }
};
    </script>
    {%endblock%}
</body>
</html>
